<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Repository Analyzer Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/side-nav.css?v=2">
    <link rel="stylesheet" href="/footer.css">
    <link rel="stylesheet" href="/auth.css">
    <style>
        /* Modern Hacker-style glassmorphism design */
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap');

        :root {
            --primary: #00ff7f;
            --primary-dark: #00cc66;
            --primary-light: rgba(0, 255, 127, 0.1);
            --secondary: #0099ff;
            --secondary-light: rgba(0, 153, 255, 0.1);
            --accent: #a777e3;
            --accent-light: rgba(167, 119, 227, 0.1);
            --danger: #ff4757;
            --danger-light: rgba(255, 71, 87, 0.1);
            --dark: #0a0a0a;
            --darker: #050505;
            --light: #f5f8ff;
            --glass-light: rgba(255, 255, 255, 0.05);
            --glass-dark: rgba(0, 0, 0, 0.3);
            --border-radius: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--darker) 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, var(--darker) 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: var(--light);
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
            padding-top: 80px;
            display: flex;
            flex-direction: column;
        }

        /* Matrix Rain Background */
        #matrix-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            pointer-events: none;
        }

        /* Enhanced Progress Header Bar */
        .progress-header-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--primary);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 30px rgba(0, 255, 127, 0.2);
            padding: 0 20px;
        }

        .progress-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            width: 100%;
        }

        .progress-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
        }

        .progress-icon {
            font-size: 24px;
            color: var(--primary);
            animation: pulse 2s infinite;
        }

        .progress-text-container {
            display: flex;
            flex-direction: column;
        }

        .progress-text {
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            text-shadow: 0 0 10px rgba(0, 255, 127, 0.8);
            letter-spacing: 0.5px;
        }

        .progress-text.info { color: var(--primary); }
        .progress-text.success { color: var(--primary); text-shadow: 0 0 15px rgba(0, 255, 127, 1); }
        .progress-text.error { color: var(--danger); text-shadow: 0 0 10px rgba(255, 71, 87, 0.8); }

        .progress-details {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: rgba(0, 255, 127, 0.8);
            margin-top: 4px;
        }

        .progress-bar-container {
            width: 400px;
            max-width: 400px;
            position: relative;
        }

        .progress-bar {
            position: relative;
            width: 100%;
            height: 24px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid var(--primary);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 
                0 0 20px rgba(0, 255, 127, 0.3),
                inset 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, 
                rgba(0, 255, 127, 0.2) 0%, 
                rgba(0, 255, 127, 0.4) 50%, 
                rgba(0, 255, 127, 0.2) 100%);
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(0, 255, 127, 0.5);
        }

        /* Animated background gradient */
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Floating particles effect */
        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--primary);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
            box-shadow: 0 0 6px var(--primary);
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
                opacity: 0;
            }
            10%, 90% {
                opacity: 1;
            }
            50% {
                transform: translateY(-100vh) rotate(180deg);
            }
        }

        /* Main Layout */
        .main-layout {
            display: flex;
            flex-direction: column;
            flex: 1;
            position: relative;
            z-index: 1;
            margin-top: 80px;
            margin-left: 80px;
            padding: 20px;
            gap: 20px;
            transition: margin-left 0.3s ease;
        }

        /* Main Content Area with improved glassmorphism */
        .main-content {
            flex: 1;
            background: var(--glass-dark);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            position: relative;
            z-index: 2;
        }

        /* Container styling */
        .container {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            padding: 40px;
            border-radius: var(--border-radius);
            border: 1px solid var(--primary-light);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        h1 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 40px;
            font-size: 2.8rem;
            font-weight: 800;
            text-shadow: 
                0 0 10px rgba(0, 255, 127, 0.5),
                0 0 20px rgba(0, 255, 127, 0.3),
                0 0 40px rgba(0, 255, 127, 0.1);
            font-family: 'JetBrains Mono', monospace;
            letter-spacing: 1px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--primary);
            font-size: 16px;
            text-shadow: 0 0 5px rgba(0, 255, 127, 0.3);
        }

        input[type="text"] {
            width: 100%;
            padding: 16px 20px;
            border: 1px solid var(--primary-light);
            border-radius: 12px;
            font-size: 16px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--light);
            transition: var(--transition);
            font-family: 'JetBrains Mono', monospace;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 
                0 0 20px rgba(0, 255, 127, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.4);
        }

        input[type="text"]::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        button {
            background: linear-gradient(135deg, var(--primary-light), rgba(0, 255, 127, 0.05));
            color: var(--primary);
            padding: 16px 30px;
            border: 1px solid var(--primary);
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, var(--primary-light), transparent);
            transition: left 0.5s ease;
        }

        button:hover::before {
            left: 100%;
        }

        button:hover {
            background: linear-gradient(135deg, rgba(0, 255, 127, 0.2), rgba(0, 255, 127, 0.1));
            box-shadow: 
                0 0 25px rgba(0, 255, 127, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        /* Test button styling */
        .test-btn {
            background-color: var(--primary-light);
            color: var(--primary);
            padding: 12px 24px;
            border: 1px solid var(--primary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: var(--transition);
            width: auto;
            display: inline-block;
            margin: 20px 0;
        }

        .test-btn:hover {
            background-color: rgba(0, 255, 127, 0.2);
            box-shadow: 0 0 15px rgba(0, 255, 127, 0.3);
        }

        /* AI Chat Section with improved glassmorphism */
        .chat-section {
            background: var(--glass-dark);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--primary-light);
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            box-shadow: 
                0 8px 32px rgba(0, 255, 127, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            z-index: 10;
            min-height: 400px;
            max-height: 600px;
        }

        /* Chat Header */
        .chat-header {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            color: var(--primary);
            padding: 20px;
            border-bottom: 1px solid var(--primary-light);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            flex-shrink: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 10px rgba(0, 255, 127, 0.5);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-header h3 i {
            color: var(--primary);
            animation: pulse 2s infinite;
        }

        .clear-btn {
            background: var(--primary-light);
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
        }

        .clear-btn:hover {
            background: rgba(0, 255, 127, 0.2);
            box-shadow: 0 0 15px rgba(0, 255, 127, 0.3);
            transform: translateY(-2px);
        }

        /* Chat Messages */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.1);
            scroll-behavior: smooth;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Improved Chat Message Styling */
        .message-container {
            display: flex;
            flex-direction: column;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        .message-container.user {
            align-self: flex-end;
        }

        .message-container.bot {
            align-self: flex-start;
        }

        .message-header {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .message-sender {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .message-sender.user {
            color: var(--secondary);
            text-shadow: 0 0 5px rgba(0, 153, 255, 0.5);
        }

        .message-sender.bot {
            color: var(--primary);
            text-shadow: 0 0 5px rgba(0, 255, 127, 0.5);
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-left: 10px;
            font-family: 'JetBrains Mono', monospace;
        }

        .message-content {
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.5;
            word-wrap: break-word;
            font-size: 14px;
            max-width: 100%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .message-container.user .message-content {
            background: linear-gradient(135deg, var(--secondary-light), rgba(0, 153, 255, 0.05));
            border: 1px solid var(--secondary);
            color: var(--light);
            border-bottom-right-radius: 4px;
        }

        .message-container.bot .message-content {
            background: linear-gradient(135deg, var(--primary-light), rgba(0, 255, 127, 0.05));
            border: 1px solid var(--primary);
            color: var(--light);
            border-bottom-left-radius: 4px;
        }

        .message-container.loading .message-content {
            background: rgba(255, 255, 0, 0.1);
            border: 1px solid rgba(255, 255, 0, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        .message-container.error .message-content {
            background: var(--danger-light);
            border: 1px solid var(--danger);
        }

        /* Chat Input Container */
        .chat-input-container {
            display: flex;
            padding: 20px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-top: 1px solid var(--primary-light);
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            gap: 15px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 15px 20px;
            border: 1px solid var(--primary);
            border-radius: 10px;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--light);
            transition: var(--transition);
            font-family: 'Inter', sans-serif;
            resize: none;
            min-height: 45px;
            max-height: 120px;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(0, 255, 127, 0.25);
            background: rgba(0, 0, 0, 0.4);
        }

        .chat-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .chat-send-btn {
            background: linear-gradient(135deg, var(--primary-light), rgba(0, 255, 127, 0.1));
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: var(--transition);
            min-width: 100px;
            height: 45px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .chat-send-btn:hover {
            background: linear-gradient(135deg, rgba(0, 255, 127, 0.2), rgba(0, 255, 127, 0.15));
            box-shadow: 0 0 20px rgba(0, 255, 127, 0.3);
            transform: translateY(-2px);
        }

        /* Analysis sections with improved glassmorphism */
        .analysis-section {
            margin-bottom: 30px;
            padding: 25px;
            border-radius: var(--border-radius);
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--primary-light);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
        }

        .analysis-section h3 {
            margin-top: 0;
            color: var(--primary);
            border-bottom: 1px solid var(--primary);
            padding-bottom: 15px;
            margin-bottom: 20px;
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 10px rgba(0, 255, 127, 0.5);
        }

        .download-section {
            margin-bottom: 30px;
            padding: 25px;
            border-radius: var(--border-radius);
            background: rgba(0, 255, 127, 0.05);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--primary);
            box-shadow: 
                0 8px 32px rgba(0, 255, 127, 0.1),
                inset 0 1px 0 rgba(0, 255, 127, 0.05);
        }

        .download-section h3 {
            margin-top: 0;
            color: var(--primary);
            border-bottom: 1px solid var(--primary);
            padding-bottom: 15px;
            margin-bottom: 20px;
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 10px rgba(0, 255, 127, 0.5);
        }

        .download-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .download-btn {
            background: linear-gradient(135deg, var(--primary-light), rgba(0, 255, 127, 0.05));
            color: var(--primary);
            padding: 12px 24px;
            border: 1px solid var(--primary);
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: var(--transition);
            width: auto;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
            position: relative;
            overflow: hidden;
        }

        .download-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, var(--primary-light), transparent);
            transition: left 0.5s ease;
        }

        .download-btn:hover::before {
            left: 100%;
        }

        .download-btn:hover {
            background: linear-gradient(135deg, rgba(0, 255, 127, 0.2), rgba(0, 255, 127, 0.1));
            box-shadow: 0 0 25px rgba(0, 255, 127, 0.3);
            transform: translateY(-2px);
        }

        .download-all-btn {
            background: linear-gradient(135deg, rgba(0, 255, 127, 0.2), rgba(0, 255, 127, 0.1));
            font-size: 16px;
            padding: 15px 30px;
            box-shadow: 0 0 20px rgba(0, 255, 127, 0.15);
        }

        .download-all-btn:hover {
            background: linear-gradient(135deg, rgba(0, 255, 127, 0.3), rgba(0, 255, 127, 0.2));
            box-shadow: 0 0 30px rgba(0, 255, 127, 0.4);
        }

        /* File sections */
        .file-section {
            margin-bottom: 25px;
            border: 1px solid var(--primary-light);
            border-radius: var(--border-radius);
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }

        .file-header {
            background: var(--primary-light);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            color: var(--primary);
            padding: 15px 20px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--primary-light);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
        }

        .file-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .file-status {
            background: rgba(0, 255, 127, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            border: 1px solid var(--primary);
            text-shadow: 0 0 5px currentColor;
        }

        .file-content {
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            overflow-x: auto;
        }

        pre {
            margin: 0;
            white-space: pre-wrap;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            color: #e0e0e0;
            text-shadow: 0 0 2px rgba(0, 255, 127, 0.15);
        }

        /* Issues styling */
        .issues-list {
            list-style-type: none;
            padding: 0;
        }

        .issue-item {
            padding: 20px;
            margin-bottom: 15px;
            border-radius: var(--border-radius);
            border: 1px solid;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
            animation: fadeIn 0.5s ease;
        }

        .issue-warning {
            background: rgba(255, 255, 0, 0.1);
            border-color: rgba(255, 255, 0, 0.3);
            color: #ffff00;
        }

        .issue-critical {
            background: var(--danger-light);
            border-color: var(--danger);
            color: #ff007f;
        }

        .issue-suggestion {
            background: rgba(0, 255, 255, 0.1);
            border-color: rgba(0, 255, 255, 0.3);
            color: #00ffff;
        }

        .issue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .issue-title {
            font-weight: 600;
            margin: 0;
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
        }

        .issue-severity {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
        }

        .severity-high {
            background: rgba(255, 0, 127, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .severity-medium {
            background: rgba(255, 255, 0, 0.2);
            color: #ffff00;
            border: 1px solid rgba(255, 255, 0, 0.4);
        }

        .severity-low {
            background: var(--primary-light);
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        /* Summary cards */
        .analysis-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            padding: 25px;
            border-radius: var(--border-radius);
            background: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--primary-light);
            text-align: center;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
            transition: var(--transition);
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.2),
                0 0 20px rgba(0, 255, 127, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .summary-card h3 {
            margin-top: 0;
            color: var(--primary);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 10px rgba(0, 255, 127, 0.5);
        }

        .summary-card .value {
            font-size: 28px;
            font-weight: 700;
            margin: 15px 0;
            color: var(--light);
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
            font-family: 'JetBrains Mono', monospace;
        }

        .summary-card .label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 13px;
            font-weight: 500;
        }

        .generated-badge {
            background: linear-gradient(135deg, var(--primary-light), rgba(0, 255, 127, 0.1));
            color: var(--primary);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            margin-top: 10px;
            display: inline-block;
            border: 1px solid var(--primary);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
        }

        /* Loading animation */
        .loading {
            text-align: center;
            padding: 60px;
            color: var(--primary);
        }

        .loading-spinner {
            border: 4px solid var(--primary-light);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
            box-shadow: 0 0 20px rgba(0, 255, 127, 0.25);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading p {
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 10px rgba(0, 255, 127, 0.5);
            font-size: 16px;
        }

        /* Error styling */
        .error {
            background: var(--danger-light);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            box-shadow: 
                0 8px 32px rgba(255, 0, 127, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
        }

        .error h3 {
            margin-top: 0;
            color: var(--danger);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 10px rgba(255, 0, 127, 0.5);
        }

        /* Scrollbar styling */
        .chat-messages::-webkit-scrollbar,
        .file-content::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track,
        .file-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb,
        .file-content::-webkit-scrollbar-thumb {
            background: var(--primary-light);
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0, 255, 127, 0.2);
        }

        .chat-messages::-webkit-scrollbar-thumb:hover,
        .file-content::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 127, 0.4);
            box-shadow: 0 0 15px rgba(0, 255, 127, 0.4);
        }

        /* Logout button styling */
        .user-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logout-btn {
            background: var(--danger-light);
            color: var(--danger);
            border: 1px solid var(--danger);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            font-family: 'JetBrains Mono', monospace;
            text-shadow: 0 0 5px currentColor;
            width: auto;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .logout-btn:hover {
            background: rgba(255, 71, 87, 0.2);
            box-shadow: 0 0 15px rgba(255, 71, 87, 0.3);
            transform: translateY(-2px);
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .progress-bar-container {
                width: 300px;
            }
            
            .progress-details {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .progress-header-bar {
                height: 70px;
                padding: 0 15px;
            }
            
            .main-layout {
                margin-top: 70px;
                margin-left: 0;
                padding: 15px;
            }
            
            body {
                padding-top: 70px;
            }
            
            .progress-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .progress-info {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .progress-bar-container {
                width: 100%;
            }
            
            .main-content, .chat-section {
                padding: 20px;
            }
            
            .container {
                padding: 25px;
            }
            
            h1 {
                font-size: 2.2rem;
                margin-bottom: 30px;
            }
            
            .analysis-summary {
                grid-template-columns: 1fr 1fr;
            }
            
            .download-buttons {
                flex-direction: column;
            }
            
            .download-btn {
                width: 100%;
            }
            
            .message-container {
                max-width: 90%;
            }
            
            .chat-input-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .chat-input, .chat-send-btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .analysis-summary {
                grid-template-columns: 1fr;
            }
            
            .progress-icon {
                display: none;
            }
            
            .file-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .file-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .message-container {
                max-width: 95%;
            }
            
            .main-content, .chat-section {
                padding: 15px;
            }
            
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>


    <!-- Matrix Rain Background -->
    <canvas id="matrix-canvas"></canvas>
    
    <!-- Floating particles for hacker effect -->
    <div class="floating-particles" id="particles"></div>
    
    <!-- Enhanced Progress Header -->
    <div class="progress-header-bar">
        <div class="progress-container">
            <div class="progress-info">
                <div class="progress-icon">
                    <i class="fas fa-code"></i>
                </div>
                <div class="progress-text-container">
                    <div class="progress-text" id="currentProgress">Ready</div>
                    <div class="progress-details" id="progressDetails">System initialized</div>
                </div>
                <div class="user-actions">
                    <button onclick="logout()" class="logout-btn" id="logoutBtn" style="display: none;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="main-layout">
        <!-- Main Content -->
        <div class="main-content">
            <div class="container">
                <h1 data-text="Repository Analyzer Pro" class="neon-glow">Repository Analyzer Pro</h1>
                
                <form id="analyzeForm">
                    <div class="form-group">
                        <label for="repoUrl"><i class="fas fa-link"></i> Repository URL:</label>
                        <input type="text" id="repoUrl" name="repoUrl" placeholder="https://github.com/username/repository" required>
                    </div>
                    <button type="submit"><i class="fas fa-search"></i> Analyze Repository</button>
                </form>
                
                <!-- Test progress bar button -->
                <div style="text-align: center; margin: 20px 0;">
                    <button onclick="testProgressBar()" class="test-btn">
                        <i class="fas fa-vial"></i> Test Progress Bar
                    </button>
                </div>

                <div id="result"></div>
            </div>
        </div>

        <!-- AI Chat Section -->
        <div class="chat-section">
            <div class="chat-header">
                <h3><i class="fas fa-robot"></i> AI Assistant</h3>
                <button onclick="clearChat()" class="clear-btn"><i class="fas fa-trash"></i> Clear Chat</button>
            </div>
            <div id="chatMessages" class="chat-messages">
                <!-- Preloaded welcome message -->
                <div class="message-container bot">
                    <div class="message-header">
                        <div class="message-sender bot">
                            <i class="fas fa-robot"></i> AI Assistant
                        </div>
                        <div class="message-time">Just now</div>
                    </div>
                    <div class="message-content">
                        Hello! I'm your AI assistant. I can help you analyze repositories, answer questions about Docker, deployment, and more. How can I assist you today?
                    </div>
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" id="chatInput" placeholder="Ask me anything about Docker, deployment, or your repository..." class="chat-input">
                <button onclick="sendChatMessage()" class="chat-send-btn">
                    <i class="fas fa-paper-plane"></i> Send
                </button>
            </div>
        </div>
    </div>

    <script>
        // Create floating particles effect
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particlesContainer.appendChild(particle);
            }
        }
        
        // Initialize particles when page loads
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
            initializeSocket();
            startMatrixRain();
        });
        
        let currentAnalysisId = null;
        let socket = null;

        // Matrix Rain Effect
        function startMatrixRain() {
            const canvas = document.getElementById('matrix-canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const letters = 'アァカサタナハマヤャラワガザダバパイィキシチニヒミリヰギジヂビピウゥクスツヌフムユュルグズブヅプエェケセテネヘメレヱゲゼデベペオォコソトノホモヨョロヲゴゾドボポヴッン0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const fontSize = 14;
            const columns = canvas.width / fontSize;
            
            const drops = [];
            for (let i = 0; i < columns; i++) {
                drops[i] = 1;
            }
            
            function draw() {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#00ff7f';
                ctx.font = `${fontSize}px 'JetBrains Mono'`;
                
                for (let i = 0; i < drops.length; i++) {
                    const text = letters[Math.floor(Math.random() * letters.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    
                    drops[i]++;
                }
            }
            
            setInterval(draw, 33);
            
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        }

        // Initialize Socket.IO connection
        function initializeSocket() {
            console.log('Initializing Socket.IO connection to: http://localhost:3000');
            // Simulating socket connection for demo purposes
            setTimeout(() => {
                addProgressMessage('Connected to server', 'info');
            }, 1000);
        }

        // Add progress message to header
        function addProgressMessage(message, type = 'info', progress = 0) {
            const currentProgress = document.getElementById('currentProgress');
            const progressDetails = document.getElementById('progressDetails');
            const progressFill = document.getElementById('progressFill');
            
            if (currentProgress) {
                currentProgress.textContent = message;
                currentProgress.className = `progress-text ${type}`;
            }
            
            if (progressDetails && progress > 0) {
                progressDetails.textContent = `Progress: ${progress}%`;
            }
            
            if (progressFill) {
                progressFill.style.width = `${progress}%`;
            }
            
            // Auto-clear after 3 seconds for non-error messages
            if (type !== 'error' && progress >= 100) {
                setTimeout(() => {
                    if (currentProgress && currentProgress.textContent === message) {
                        currentProgress.textContent = 'Ready';
                        currentProgress.className = 'progress-text';
                        if (progressDetails) {
                            progressDetails.textContent = 'System initialized';
                        }
                        if (progressFill) {
                            progressFill.style.width = '0%';
                        }
                    }
                }, 3000);
            }
        }

        // Clear progress messages
        function clearProgress() {
            const currentProgress = document.getElementById('currentProgress');
            const progressDetails = document.getElementById('progressDetails');
            const progressFill = document.getElementById('progressFill');
            currentProgress.textContent = 'Ready';
            currentProgress.className = 'progress-text';
            progressDetails.textContent = 'System initialized';
            progressFill.style.width = '0%';
        }

        // Test progress bar function
        function testProgressBar() {
            addProgressMessage('Testing...', 'info', 25);
            setTimeout(() => addProgressMessage('Halfway...', 'info', 50), 1000);
            setTimeout(() => addProgressMessage('Almost done...', 'info', 75), 2000);
            setTimeout(() => addProgressMessage('Complete!', 'success', 100), 3000);
        }

        // Clear chat messages
        function clearChat() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';
            
            // Add a new welcome message after clearing
            addChatMessage('AI Assistant', 'Hello! How can I help you today?', 'bot');
        }

        document.getElementById('analyzeForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const repoUrl = document.getElementById('repoUrl').value;
            const resultDiv = document.getElementById('result');
            
            // Clear previous results and show progress
            resultDiv.innerHTML = '';
            clearProgress();
            addProgressMessage('🚀 Starting analysis...', 'info', 10);
            
            // Show loading state
            resultDiv.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Analyzing repository...</p>
                </div>
            `;
            
            try {
                // Simulate API call for demo
                setTimeout(() => {
                    addProgressMessage('📡 Processing response...', 'info', 50);
                    
                    // Simulate successful response
                    setTimeout(() => {
                        addProgressMessage('✅ Analysis completed successfully!', 'success', 100);
                        
                        // Display mock results
                        displayResults({
                            success: true,
                            analysisId: 'mock-' + Date.now(),
                            analysis: {
                                totalFiles: 42,
                                dockerfile: { exists: true },
                                compose: { exists: false },
                                readme: { exists: true }
                            },
                            generated: {
                                dockerfile: false,
                                compose: true,
                                readme: false
                            },
                            issues: [
                                {
                                    title: "Missing Docker Compose",
                                    message: "No docker-compose.yml file found. We've generated one for you.",
                                    severity: "medium",
                                    type: "warning"
                                },
                                {
                                    title: "Outdated Base Image",
                                    message: "Consider using a more recent version of the base image for security patches.",
                                    severity: "low",
                                    type: "suggestion"
                                }
                            ],
                            files: {
                                dockerfile: "FROM node:16-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY . .\nEXPOSE 3000\nCMD [\"npm\", \"start\"]",
                                compose: "version: '3.8'\nservices:\n  app:\n    build: .\n    ports:\n      - \"3000:3000\"\n    environment:\n      NODE_ENV: production",
                                readme: "# Example Repository\n\nThis is a sample repository for demonstration purposes."
                            }
                        });
                    }, 1500);
                }, 2000);
            } catch (error) {
                addProgressMessage(`❌ Failed to analyze repository: ${error.message}`, 'error', 0);
                resultDiv.innerHTML = `
                    <div class="error">
                        <h3>Error</h3>
                        <p>Failed to analyze repository: ${error.message}</p>
                    </div>
                `;
            }
        });

        function displayResults(data) {
            const resultDiv = document.getElementById('result');
            
            let html = `
                <div class="analysis-section">
                    <h3>Analysis Summary</h3>
                    <div class="analysis-summary">
                        <div class="summary-card">
                            <h3>Files Found</h3>
                            <div class="value">${data.analysis.totalFiles}</div>
                            <div class="label">Total files in repository</div>
                        </div>
                        <div class="summary-card">
                            <h3>Dockerfile</h3>
                            <div class="value">${data.analysis.dockerfile.exists ? '✅' : '❌'}</div>
                            <div class="label">${data.analysis.dockerfile.exists ? 'Found' : 'Missing'}</div>
                            ${data.generated.dockerfile ? '<div class="generated-badge">Generated</div>' : ''}
                        </div>
                        <div class="summary-card">
                            <h3>Docker Compose</h3>
                            <div class="value">${data.analysis.compose.exists ? '✅' : '❌'}</div>
                            <div class="label">${data.analysis.compose.exists ? 'Found' : 'Missing'}</div>
                            ${data.generated.compose ? '<div class="generated-badge">Generated</div>' : ''}
                        </div>
                        <div class="summary-card">
                            <h3>README</h3>
                            <div class="value">${data.analysis.readme.exists ? '✅' : '❌'}</div>
                            <div class="label">${data.analysis.readme.exists ? 'Found' : 'Missing'}</div>
                            ${data.generated.readme ? '<div class="generated-badge">Generated</div>' : ''}
                        </div>
                    </div>
                </div>
            `;

            // Add download all button
            html += `
                <div class="download-section">
                    <h3>Download Files</h3>
                    <div class="download-buttons">
                        <button class="download-btn download-all-btn" onclick="downloadAllFiles()">
                            <i class="fas fa-download"></i> Download All Files (ZIP)
                        </button>
                    </div>
                </div>
            `;

            // Display issues if any
            if (data.issues && data.issues.length > 0) {
                html += `
                    <div class="analysis-section">
                        <h3>Issues & Recommendations</h3>
                        <ul class="issues-list">
                `;
                
                data.issues.forEach(issue => {
                    const severityClass = `severity-${issue.severity}`;
                    const issueClass = `issue-${issue.type}`;
                    
                    html += `
                        <li class="issue-item ${issueClass}">
                            <div class="issue-header">
                                <h4 class="issue-title">${issue.title}</h4>
                                <span class="issue-severity ${severityClass}">${issue.severity}</span>
                            </div>
                            <p>${issue.message}</p>
                        </li>
                    `;
                });
                
                html += `
                        </ul>
                    </div>
                `;
            }

            // Display file contents
            html += `
                <div class="analysis-section">
                    <h3>File Contents</h3>
            `;

            if (data.files.dockerfile) {
                html += `
                    <div class="file-section">
                        <div class="file-header">
                            <span>Dockerfile</span>
                            <div class="file-actions">
                                <span class="file-status">${data.generated.dockerfile ? 'Generated' : 'Existing'}</span>
                                <button class="download-btn" onclick="downloadFile('dockerfile')">
                                    <i class="fas fa-download"></i> Download
                                </button>
                            </div>
                        </div>
                        <div class="file-content">
                            <pre>${escapeHtml(data.files.dockerfile)}</pre>
                        </div>
                    </div>
                `;
            }

            if (data.files.compose) {
                html += `
                    <div class="file-section">
                        <div class="file-header">
                            <span>docker-compose.yml</span>
                            <div class="file-actions">
                                <span class="file-status">${data.generated.compose ? 'Generated' : 'Existing'}</span>
                                <button class="download-btn" onclick="downloadFile('compose')">
                                    <i class="fas fa-download"></i> Download
                                </button>
                            </div>
                        </div>
                        <div class="file-content">
                            <pre>${escapeHtml(data.files.compose)}</pre>
                        </div>
                    </div>
                `;
            }

            if (data.files.readme) {
                html += `
                    <div class="file-section">
                        <div class="file-header">
                            <span>README.md</span>
                            <div class="file-actions">
                                <span class="file-status">${data.generated.readme ? 'Generated' : 'Existing'}</span>
                                <button class="download-btn" onclick="downloadFile('readme')">
                                    <i class="fas fa-download"></i> Download
                                </button>
                            </div>
                        </div>
                        <div class="file-content">
                            <pre>${escapeHtml(data.files.readme)}</pre>
                        </div>
                    </div>
                `;
            }

            html += `
                </div>
            `;

            resultDiv.innerHTML = html;
            currentAnalysisId = data.analysisId;
        }

        function downloadFile(fileType) {
            if (!currentAnalysisId) {
                alert('No analysis available for download');
                return;
            }
            
            // Simulate download for demo
            addProgressMessage(`Downloading ${fileType}...`, 'info', 0);
            setTimeout(() => {
                addProgressMessage(`Downloaded ${fileType} successfully`, 'success', 100);
            }, 1000);
        }

        function downloadAllFiles() {
            if (!currentAnalysisId) {
                alert('No analysis available for download');
                return;
            }
            
            // Simulate download for demo
            addProgressMessage('Downloading all files...', 'info', 0);
            setTimeout(() => {
                addProgressMessage('Downloaded all files successfully', 'success', 100);
            }, 1500);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Chat functionality
        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const messages = document.getElementById('chatMessages');
            const message = input.value.trim();

            if (!message) return;

            // Add user message
            addChatMessage('You', message, 'user');
            input.value = '';

            // Show loading indicator
            const loadingId = addChatMessage('AI Assistant', 'Thinking...', 'bot', 'loading');

            try {
                // Simulate API call for demo
                setTimeout(() => {
                    // Remove loading message
                    const loadingElement = document.getElementById(loadingId);
                    if (loadingElement) {
                        loadingElement.remove();
                    }

                    // Add response based on message content
                    let response = "I can help you with Docker, deployment, and repository analysis. What would you like to know?";
                    
                    if (message.toLowerCase().includes('docker')) {
                        response = "Docker is a platform that enables developers to build, ship, and run applications in containers. It provides isolation and consistency across environments. You can use Docker to containerize your application and its dependencies, making deployment much easier.";
                    } else if (message.toLowerCase().includes('deploy')) {
                        response = "For deployment, you can use Docker containers, which provide consistent environments from development to production. You might also consider using orchestration tools like Kubernetes for managing containers at scale. Would you like me to generate deployment configuration files for your project?";
                    } else if (message.toLowerCase().includes('compose')) {
                        response = "Docker Compose is a tool for defining and running multi-container Docker applications. You use a YAML file to configure your application's services, then run a single command to create and start all the services. I can help you create or optimize a docker-compose.yml file for your project.";
                    } else if (message.toLowerCase().includes('help') || message.toLowerCase().includes('what can you do')) {
                        response = "I can help you with:\n- Analyzing GitHub repositories\n- Docker and containerization questions\n- Deployment strategies\n- Generating Dockerfiles\n- Creating docker-compose.yml files\n- Writing documentation\n- Identifying issues in your project setup\n\nWhat would you like assistance with?";
                    }
                    
                    addChatMessage('AI Assistant', response, 'bot');
                }, 1500);
            } catch (error) {
                // Remove loading message
                const loadingElement = document.getElementById(loadingId);
                if (loadingElement) {
                    loadingElement.remove();
                }
                addChatMessage('AI Assistant', `Error: ${error.message}`, 'bot', 'error');
            }
        }

        function addChatMessage(sender, message, type, status = '') {
            const messages = document.getElementById('chatMessages');
            const messageId = 'msg-' + Date.now();
            
            const messageDiv = document.createElement('div');
            messageDiv.id = messageId;
            messageDiv.className = `message-container ${type} ${status}`;
            
            const timestamp = new Date().toLocaleTimeString();
            
            messageDiv.innerHTML = `
                <div class="message-header">
                    <div class="message-sender ${type}">
                        ${type === 'bot' ? '<i class="fas fa-robot"></i>' : '<i class="fas fa-user"></i>'} 
                        ${sender}
                    </div>
                    <div class="message-time">${timestamp}</div>
                </div>
                <div class="message-content">${formatMessage(message)}</div>
            `;
            
            messages.appendChild(messageDiv);
            
            // Smooth scroll to bottom
            setTimeout(() => {
                messages.scrollTo({
                    top: messages.scrollHeight,
                    behavior: 'smooth'
                });
            }, 100);
            
            return messageId;
        }

        function formatMessage(message) {
            // Convert markdown-like formatting to HTML
            return message
                // Headers
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                // Bold
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                // Italic
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                // Code blocks
                .replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>')
                // Inline code
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                // Lists
                .replace(/^\* (.*$)/gim, '<li>$1</li>')
                .replace(/^- (.*$)/gim, '<li>$1</li>')
                // Wrap lists in ul tags
                .replace(/(<li>.*<\/li>)/gim, '<ul>$1</ul>')
                // Line breaks
                .replace(/\n/g, '<br>')
                // Clean up multiple line breaks
                .replace(/<br><br>/g, '</p><p>')
                .replace(/^(.*)$/gim, '<p>$1</p>')
                // Clean up empty paragraphs
                .replace(/<p><\/p>/g, '')
                .replace(/<p><br><\/p>/g, '');
        }

        // Allow Enter key to send message
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        });
    </script>
    
    <!-- Side Navigation Script -->
    <script src="/side-nav.js?v=3"></script>
    
    <!-- Footer Script -->
    <script src="/footer.js?v=1"></script>
    
    <!-- Firebase Configuration -->
    <script src="/firebase-config.js"></script>
    
    <!-- Authentication Script -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB6rxGQewpeZ-zbVwETTE0OFvSiN0_Kkcs",
            authDomain: "zeroops-77de2.firebaseapp.com",
            projectId: "zeroops-77de2",
            storageBucket: "zeroops-77de2.firebasestorage.app",
            messagingSenderId: "511958088139",
            appId: "1:511958088139:web:521c94d1921b0412339e4e",
            measurementId: "G-FGVTV2WRKB"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Logout function
        window.logout = async function() {
            try {
                await auth.signOut();
                window.location.href = 'login.html';
            } catch (error) {
                console.error('Logout error:', error);
            }
        };

        // Check authentication state
        onAuthStateChanged(auth, (user) => {
            if (!user) {
                // User is not signed in, redirect to login page
                window.location.href = 'login.html';
            } else {
                // User is signed in, show user info
                console.log('User is signed in:', user.email);
                
                // Update UI to show user is logged in
                const progressText = document.getElementById('currentProgress');
                const logoutBtn = document.getElementById('logoutBtn');
                
                if (progressText) {
                    progressText.textContent = `Welcome, ${user.email}`;
                }
                
                if (logoutBtn) {
                    logoutBtn.style.display = 'inline-flex';
                }
            }
        });
    </script>
</body>
</html>